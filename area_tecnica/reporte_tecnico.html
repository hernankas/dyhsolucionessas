<?php
require_once('tcpdf/tcpdf.php'); // Asegúrate de que la ruta sea correcta

// Crear nuevo documento PDF
$pdf = new TCPDF();
$pdf->SetCreator(PDF_CREATOR);
$pdf->SetAuthor('Nombre del Técnico');
$pdf->SetTitle('Reporte Técnico');

// Configurar márgenes extremadamente pequeños
$pdf->SetMargins(5, 5, 5); // Márgenes muy pequeños para aprovechar el espacio
$pdf->SetHeaderMargin(5);  // Margen pequeño para el encabezado
$pdf->SetFooterMargin(5);  // Margen pequeño para el pie de página

// Salto de página automático con un margen inferior más pequeño
$pdf->SetAutoPageBreak(TRUE, 5);

// Agregar una página
$pdf->AddPage();

// Configurar fuente más pequeña
$pdf->SetFont('helvetica', '', 8); // Tamaño de letra más pequeño

// Contenido del encabezado de la empresa
$empresa = "
<h2 style='font-size: 12px;'>Nombre de la Empresa</h2>
<p style='font-size: 10px;'>Dirección de la Empresa</p>
<p style='font-size: 10px;'>Teléfono: (XXX) XXX-XXXX</p>
<p style='font-size: 10px;'>Email: contacto@empresa.com</p>
";

// Escribir el contenido del encabezado en el PDF
$pdf->writeHTML($empresa, true, false, true, false, '');

// Obtener datos del formulario
$cliente = $_POST['cliente'];
$tecnico = $_POST['tecnico'];
$fecha = $_POST['fecha'];
$ubicacion = $_POST['ubicacion'];
$equipo = $_POST['equipo'];
$equipo_otro = isset($_POST['equipo_otro']) ? $_POST['equipo_otro'] : '';
$descripcion = $_POST['descripcion'];
$solucion = $_POST['solucion'];
$estado = $_POST['estado'];
$observaciones = $_POST['observaciones'];
$firma = $_POST['firma'];

// Contenido del reporte técnico ajustado para que se vea completo en una página
$html = "
<style>
    h2 {
        text-align: center;
        font-size: 12px; /* Tamaño de letra más pequeño */
        margin-bottom: 10px;
    }
    .container {
        border: 1px solid #000;
        padding: 5px; /* Reducir padding para ahorrar espacio */
    }
    p {
        font-size: 8px; /* Fuente más pequeña para que quepa más texto */
        line-height: 1.2; /* Espaciado entre líneas ajustado */
        margin-bottom: 5px; /* Menor espacio entre párrafos */
    }
    strong {
        font-weight: bold;
    }
</style>

<div class='container'>
    <h2>Reporte Técnico</h2>
    <p><strong>Nombre del Cliente:</strong> $cliente</p>
    <p><strong>Nombre del Técnico:</strong> $tecnico</p>
    <p><strong>Fecha de Revisión:</strong> $fecha</p>
    <p><strong>Ubicación del Equipo:</strong> $ubicacion</p>
    <p><strong>Tipo de Equipo:</strong> $equipo" . ($equipo === 'otros' ? " - $equipo_otro" : "") . "</p>
    <p><strong>Descripción del Problema:</strong><br/> $descripcion</p>
    <p><strong>Solución Realizada:</strong><br/> $solucion</p>
    <p><strong>Estado General del Equipo:</strong> $estado</p>
    <p><strong>Observaciones Adicionales:</strong><br/> $observaciones</p>
    <p><strong>Firma del Técnico:</strong> $firma</p>
</div>
";

// Escribir contenido HTML en el PDF
$pdf->writeHTML($html, true, false, true, false, '');

// Cerrar y enviar el PDF al navegador
$pdf->Output('reporte_tecnico.pdf', 'I'); // 'I' para mostrar en el navegador
?>
