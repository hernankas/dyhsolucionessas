<?php
require_once('tcpdf/tcpdf.php'); // Asegúrate de que la ruta sea correcta

// Crear nuevo documento PDF
$pdf = new TCPDF();
$pdf->SetCreator(PDF_CREATOR);
$pdf->SetAuthor('Nombre del Técnico');
$pdf->SetTitle('Reporte Técnico');

// Configurar márgenes más pequeños: izquierda, arriba, derecha
$pdf->SetMargins(10, 10, 10); // Márgenes más pequeños
$pdf->SetHeaderMargin(5);  // Margen para el encabezado
$pdf->SetFooterMargin(10);  // Margen para el pie de página

// Salto de página automático
$pdf->SetAutoPageBreak(TRUE, 10); // Menor margen inferior para más contenido

// Agregar una página
$pdf->AddPage();

// Configurar fuente más pequeña
$pdf->SetFont('helvetica', '', 10); // Texto más pequeño para mayor espacio

// Contenido del encabezado de la empresa
$empresa = "
<h2>Nombre de la Empresa</h2>
<p>Dirección de la Empresa</p>
<p>Teléfono: (XXX) XXX-XXXX</p>
<p>Email: contacto@empresa.com</p>
";

// Escribir el contenido del encabezado en el PDF
$pdf->writeHTML($empresa, true, false, true, false, '');

// Obtener datos del formulario
$cliente = $_POST['cliente'];
$tecnico = $_POST['tecnico'];
$fecha = $_POST['fecha'];
$ubicacion = $_POST['ubicacion'];
$equipo = $_POST['equipo'];
$equipo_otro = isset($_POST['equipo_otro']) ? $_POST['equipo_otro'] : '';
$descripcion = $_POST['descripcion'];
$solucion = $_POST['solucion'];
$estado = $_POST['estado'];
$observaciones = $_POST['observaciones'];
$firma = $_POST['firma'];

// Contenido del reporte técnico ajustado para que se vea completo
$html = "
<style>
    h2 {
        text-align: center;
        font-size: 16px; /* Tamaño de letra más pequeño */
        margin-bottom: 15px;
    }
    .container {
        border: 1px solid #000;
        padding: 8px; /* Reducir padding para ahorrar espacio */
    }
    p {
        font-size: 10px; /* Fuente más pequeña para que quepa más texto */
        line-height: 1.3; /* Espaciado entre líneas ajustado */
        margin-bottom: 8px; /* Menor espacio entre párrafos */
    }
    strong {
        font-weight: bold;
    }
</style>

<div class='container'>
    <h2>Reporte Técnico</h2>
    <p><strong>Nombre del Cliente:</strong> $cliente</p>
    <p><strong>Nombre del Técnico:</strong> $tecnico</p>
    <p><strong>Fecha de Revisión:</strong> $fecha</p>
    <p><strong>Ubicación del Equipo:</strong> $ubicacion</p>
    <p><strong>Tipo de Equipo:</strong> $equipo" . ($equipo === 'otros' ? " - $equipo_otro" : "") . "</p>
    <p><strong>Descripción del Problema:</strong><br/> $descripcion</p>
    <p><strong>Solución Realizada:</strong><br/> $solucion</p>
    <p><strong>Estado General del Equipo:</strong> $estado</p>
    <p><strong>Observaciones Adicionales:</strong><br/> $observaciones</p>
    <p><strong>Firma del Técnico:</strong> $firma</p>
</div>
";

// Escribir contenido HTML en el PDF
$pdf->writeHTML($html, true, false, true, false, '');

// Cerrar y enviar el PDF al navegador
$pdf->Output('reporte_tecnico.pdf', 'I'); // 'I' para mostrar en el navegador
?>
